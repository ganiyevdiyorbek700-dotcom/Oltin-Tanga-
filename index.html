<!DOCTYPE html>
<html lang="uz">
<head>
    <meta name="monetag" content="6d6c27c8cb845b8dc1e72729aa2b63ab">
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Oltin Tanga - Mining & Rewards</title>
    
    <script src='//libtl.com/sdk.js' data-zone='10558007' data-sdk='show_10558007'></script>
    
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <style>
        :root { --gold: #ffd700; --bg: #0b0d17; --card: #161b22; }
        body { margin: 0; background: var(--bg); color: white; font-family: sans-serif; overflow: hidden; }
        .page { display: none; height: 100vh; padding: 20px; box-sizing: border-box; overflow-y: auto; padding-bottom: 90px; }
        .active { display: block; }
        #toast { position: fixed; top: 20px; left: 50%; transform: translateX(-50%); padding: 12px 25px; border-radius: 30px; z-index: 1000; display: none; font-weight: bold; }
        
        /* Mining Section */
        .stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px; }
        .stat-card { background: var(--card); padding: 10px; border-radius: 12px; text-align: center; border: 1px solid #333; }
        .coin-btn { width: 180px; height: 180px; background: radial-gradient(circle, #f1c40f, #d35400); border-radius: 50%; margin: 30px auto; border: 6px solid #f39c12; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 60px; transition: 0.1s; box-shadow: 0 0 20px rgba(241, 196, 15, 0.3); }
        .coin-btn:active { transform: scale(0.9); }

        /* General UI */
        .card { background: var(--card); padding: 15px; border-radius: 15px; border: 1px solid #333; margin-bottom: 10px; }
        .btn { background: var(--gold); color: black; border: none; padding: 12px; border-radius: 8px; font-weight: bold; width: 100%; cursor: pointer; }
        .nav { position: fixed; bottom: 0; width: 100%; display: flex; background: #070912; padding: 10px 0; border-top: 1px solid #222; }
        .nav-item { flex: 1; text-align: center; font-size: 11px; color: #666; cursor: pointer; }
        .nav-active { color: var(--gold); }
        .rank-item { display: flex; justify-content: space-between; padding: 10px; border-bottom: 1px solid #222; }
    </style>
</head>
<body>

<div id="toast"></div>

<div id="p-home" class="page active">
    <div class="stats-grid">
        <div class="stat-card"><small>Tanga</small><br><b id="coins">0</b></div>
        <div class="stat-card"><small>Olmos</small><br><b id="diams">0</b></div>
    </div>
    <div class="coin-btn" onclick="handleTap()">ğŸ“€</div>
    <div style="text-align:center;">
        <p>âš¡ Energiya: <span id="energy">1000</span></p>
        <p>â› Mining: <span id="hrate">0</span>/soat</p>
    </div>
</div>

<div id="p-bonus" class="page">
    <h2>Bonuslar ğŸ</h2>
    <div class="card">
        <h3>Kunlik Bonus</h3>
        <p>Reklama ko'rib 5,000 ğŸ“€ oling</p>
        <button class="btn" onclick="runAd('daily')">Bonusni olish ğŸ¬</button>
    </div>
    <div class="card">
        <h3>Omadli Tanga</h3>
        <p>Tasodifiy yutuq (0-25k)</p>
        <button class="btn" style="background:#e67e22;" onclick="runAd('lucky')">Reklama ko'rish ğŸ¬</button>
    </div>
</div>

<div id="p-rank" class="page">
    <h2>Reyting ğŸ†</h2>
    <div id="rank-list" class="card">Yuklanmoqda...</div>
</div>

<div id="p-boost" class="page">
    <h2>Bosterlar âš¡</h2>
    <div class="card">
        <p>Tap Kuchi (Lvl: <span id="lvl-tap">1</span>)</p>
        <button class="btn" onclick="buy('tap')">Yangilash (<span id="price-tap">500</span> ğŸ“€)</button>
    </div>
    <div class="card">
        <p>Mining Tezligi (Lvl: <span id="lvl-mine">0</span>)</p>
        <button class="btn" onclick="buy('mine')">Yangilash (<span id="price-mine">1000</span> ğŸ“€)</button>
    </div>
</div>

<div class="nav">
    <div class="nav-item nav-active" onclick="tab('home', this)">ğŸ <br>Uy</div>
    <div class="nav-item" onclick="tab('bonus', this)">ğŸ<br>Bonus</div>
    <div class="nav-item" onclick="tab('rank', this)">ğŸ†<br>Rank</div>
    <div class="nav-item" onclick="tab('boost', this)">âš¡<br>Boster</div>
</div>

<script>
    const tg = window.Telegram.WebApp;
    const firebaseConfig = { databaseURL: "https://oltin-tanga-d2c80-default-rtdb.firebaseio.com" };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const user = tg.initDataUnsafe.user || { id: "test_123", first_name: "O'yinchi" };

    let s = { coins: 0, diams: 0, energy: 1000, tap: 1, mine: 0 };

    // Yuklash
    db.ref('users/' + user.id).on('value', snap => {
        if(snap.exists()) {
            const d = snap.val();
            s.coins = Number(d.coins) || 0;
            s.diams = Number(d.diams) || 0;
            s.energy = Number(d.energy) || 1000;
            s.tap = Number(d.tap) || 1;
            s.mine = Number(d.mine) || 0;
            updateUI();
        } else { save(); }
    });

    function handleTap() {
        if(s.energy >= s.tap) {
            s.coins += s.tap; s.energy -= s.tap;
            updateUI();
        }
    }

    // REKLAMA FUNKSIYASI (Muvaffaqiyatli Verify bo'lgandan keyin ishlaydi)
    function runAd(type) {
        if (typeof show_10558007 === 'function') {
            show_10558007().then(() => {
                let reward = type === 'daily' ? 5000 : Math.floor(Math.random() * 25001);
                s.coins += reward;
                save();
                showToast(`Tabriklaymiz! +${reward} ğŸ“€ berildi!`, "#2ecc71");
            }).catch(() => showToast("Reklama hozircha tayyor emas!", "#e74c3c"));
        } else {
            showToast("SDK yuklanmadi!", "#e74c3c");
        }
    }

    function buy(type) {
        let price = type === 'tap' ? s.tap * 500 : (s.mine/10 + 1) * 1000;
        if(s.coins >= price) {
            s.coins -= price;
            if(type === 'tap') s.tap++; else s.mine += 10;
            save();
            showToast("Boster sotib olindi!", "#2ecc71");
        } else {
            showToast("Mablag' yetarli emas!", "#e74c3c");
        }
    }

    function loadRank() {
        db.ref('users').orderByChild('coins').limitToLast(10).once('value', snap => {
            let html = '', list = [];
            snap.forEach(u => list.push(u.val()));
            list.reverse().forEach((u, i) => {
                html += `<div class="rank-item"><span>${i+1}. ${u.first_name || 'User'}</span><b>${Math.floor(u.coins)}</b></div>`;
            });
            document.getElementById('rank-list').innerHTML = html;
        });
    }

    function tab(id, el) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.getElementById('p-' + id).classList.add('active');
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('nav-active'));
        el.classList.add('nav-active');
        if(id === 'rank') loadRank();
    }

    function updateUI() {
        document.getElementById('coins').innerText = Math.floor(s.coins).toLocaleString();
        document.getElementById('diams').innerText = Math.floor(s.diams).toLocaleString();
        document.getElementById('energy').innerText = Math.floor(s.energy);
        document.getElementById('hrate').innerText = s.mine;
        document.getElementById('lvl-tap').innerText = s.tap;
        document.getElementById('lvl-mine').innerText = s.mine;
        document.getElementById('price-tap').innerText = s.tap * 500;
        document.getElementById('price-mine').innerText = (s.mine/10 + 1) * 1000;
    }

    function showToast(m, c) {
        const t = document.getElementById('toast');
        t.innerText = m; t.style.background = c; t.style.display = 'block';
        setTimeout(() => t.style.display = 'none', 3000);
    }

    function save() { db.ref('users/' + user.id).update({...s, first_name: user.first_name}); }

    setInterval(() => {
        s.energy = Math.min(1000, s.energy + 1);
        s.coins += (s.mine / 3600);
        updateUI();
    }, 1000);
    
    setInterval(save, 10000);
    tg.expand();
</script>
</body>
            </html>
    

    
    
    

                                                                                   
            
                
            
    
        
        
    
        
                                                       
        
                                    
        
        
    
                                        
                                                                     
        
    
                                                              
            
    
            
            
                                                      
                

