<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Oltin Tanga - Official</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://alwingulla.com/tag.min.js" data-zone="10558007" async></script>
    
    <style>
        :root { --bg: #050810; --accent: #f59e0b; --card: #111827; --purple: #7c3aed; }
        body { background: var(--bg); color: white; font-family: 'Segoe UI', sans-serif; margin: 0; padding-bottom: 100px; text-align: center; user-select: none; overflow: hidden; }
        
        /* Stats Panel */
        .header-stats { display: flex; justify-content: space-around; padding: 12px; background: rgba(0,0,0,0.6); gap: 8px; }
        .stat-box { background: #1a1f2e; border: 1px solid #374151; border-radius: 12px; flex: 1; padding: 8px; }
        .stat-label { font-size: 9px; color: #9ca3af; display: block; }
        .stat-value { font-size: 13px; font-weight: bold; color: var(--accent); }

        /* Main Game Area */
        .total-coins { font-size: 55px; font-weight: 900; color: #facc15; margin: 20px 0 5px; }
        .diamond-ui { color: #00d4ff; font-weight: bold; margin-bottom: 15px; font-size: 18px; }
        
        .tanga-container { position: relative; height: 260px; display: flex; align-items: center; justify-content: center; }
        .main-tanga { 
            width: 210px; height: 210px; border-radius: 50%; 
            background: radial-gradient(circle, #facc15 0%, #ca8a04 100%); 
            border: 10px solid #854d0e; 
            display: flex; align-items: center; justify-content: center; 
            font-size: 70px; font-weight: 900; color: white; transition: 0.1s; z-index: 5;
        }
        .main-tanga:active { transform: scale(0.92); }

        /* Side Buttons (Gift & Spin) */
        .side-btn { position: absolute; width: 55px; height: 55px; border-radius: 50%; background: #111; border: 2px solid var(--accent); display: flex; align-items: center; justify-content: center; font-size: 25px; z-index: 10; cursor: pointer; }
        .btn-daily { left: 30px; } 
        .btn-spin { right: 30px; background: conic-gradient(red, yellow, green, blue, red); }

        /* Energy & Progress */
        .energy-info { font-weight: bold; margin: 15px 0 5px; }
        .progress-container { width: 85%; background: #1f2937; height: 12px; border-radius: 10px; margin: 0 auto; overflow: hidden; }
        #energy-fill { background: linear-gradient(90deg, #facc15, #f59e0b); height: 100%; width: 100%; transition: 0.3s; }

        /* Modal Sections */
        .section { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--bg); z-index: 2000; padding: 25px; box-sizing: border-box; overflow-y: auto; }
        .section.active { display: block; }
        .card { background: var(--card); padding: 15px; border-radius: 16px; margin-bottom: 12px; border: 1px solid #374151; }
        
        input { width: 90%; padding: 12px; border-radius: 10px; border: 1px solid var(--accent); background: #000; color: white; text-align: center; margin-bottom: 10px; }
        .btn-action { background: var(--accent); color: black; border: none; padding: 12px; border-radius: 10px; font-weight: bold; width: 100%; cursor: pointer; }
        .btn-close { background: #374151; color: white; margin-top: 10px; }

        /* Nav Bar */
        .nav-bar { position: fixed; bottom: 0; width: 100%; background: #0f172a; display: flex; justify-content: space-around; padding: 12px 0; border-top: 1px solid #1e293b; z-index: 1000; }
        .nav-item { flex: 1; font-size: 10px; color: #94a3b8; cursor: pointer; }
        .nav-item.active { color: var(--accent); }
    </style>
</head>
<body>
    <audio id="bg-music" loop src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3"></audio>

    <div id="main-ui">
        <div class="header-stats">
            <div class="stat-box"><span class="stat-label">STATUS</span><span id="st-ui" class="stat-value">Bronza</span></div>
            <div class="stat-box"><span class="stat-label">SOATIGA</span><span id="h-ui" class="stat-value">0</span></div>
            <div class="stat-box"><span class="stat-label">ENERGEAY</span><span id="e-val" class="stat-value">500</span></div>
        </div>

        <div class="total-coins" id="c-ui">0</div>
        <div class="diamond-ui">ğŸ’ <span id="d-ui">0</span></div>

        <div class="tanga-container">
            <div class="side-btn btn-daily" onclick="openSec('daily')">ğŸ</div>
            <div id="tanga" class="main-tanga" onclick="handleTap(event)">1</div>
            <div class="side-btn btn-spin" onclick="openSec('spin')">ğŸ¡</div>
        </div>

        <div class="energy-info">âš¡ <span id="e-text">500 / 500</span></div>
        <div class="progress-container"><div id="energy-fill"></div></div>
        <p>Tap kuchi: <b id="p-ui">1</b></p>
    </div>

    <div id="boost-sec" class="section">
        <h2>âš¡ Boosterlar</h2>
        <div class="card">Tap Kuchi (+1) <br> <small id="p-cost">500 ğŸ’°</small> <button class="btn-action" onclick="buy('p')">LEVEL UP</button></div>
        <div class="card">Soatbay Foyda (+100) <br> <small id="h-cost">1000 ğŸ’°</small> <button class="btn-action" onclick="buy('h')">LEVEL UP</button></div>
        <div class="card">Max Energiya (+500) <br> <small id="e-cost">2000 ğŸ’°</small> <button class="btn-action" onclick="buy('e')">LEVEL UP</button></div>
        <button class="btn-action btn-close" onclick="closeAll()">YOPISH</button>
    </div>

    <div id="market-sec" class="section">
        <h2>ğŸ›’ Market</h2>
        <div class="card">
            <p>1,000 Tanga = 1 Olmos ğŸ’</p>
            <input type="number" id="m-input" placeholder="Qancha almashtirasiz?">
            <button class="btn-action" onclick="exchange()">ALMASHTIRISH</button>
        </div>
        <button class="btn-action btn-close" onclick="closeAll()">YOPISH</button>
    </div>

    <div id="ref-sec" class="section">
        <h2>ğŸ‘¥ Referal</h2>
        <div class="card">Chaqirilganlar: <b id="ref-count">0</b> ta</div>
        <div class="card">Yig'ilgan bonus: <b id="ref-money">0</b> ğŸ’° <button class="btn-action" onclick="claimRef()">OLISH</button></div>
        <div class="card"><small id="ref-url">yuklanmoqda...</small></div>
        <button class="btn-action btn-close" onclick="closeAll()">YOPISH</button>
    </div>

    <div id="leader-sec" class="section">
        <h2>ğŸ“Š Leaderboard</h2>
        <div class="card" style="border: 2px solid gold;">1. <span id="my-name">Siz</span> <span id="my-score" style="float:right">0</span></div>
        <div id="other-players"></div>
        <button class="btn-action btn-close" onclick="closeAll()">YOPISH</button>
    </div>

    <div id="home-sec" class="section">
        <h2>ğŸ  Mening Uyim</h2>
        <div class="card">Ism: <b id="h-name">...</b> <br> ID: <b id="h-id">...</b></div>
        <div class="card">ğŸ’° Balans: <span id="h-c">0</span> <br> ğŸ’ Olmoslar: <span id="h-d">0</span></div>
        <button class="btn-action" style="background:linear-gradient(to right, #7c3aed, #db2777); color:white" onclick="alert('Tez kunda! Tonga almashtirilish boshlandi.')">ğŸš€ AIRDROP</button>
        <button class="btn-action btn-close" onclick="closeAll()">YOPISH</button>
    </div>

    <div class="nav-bar">
        <div class="nav-item" onclick="openSec('market')">ğŸ›’<br>MARKET</div>
        <div class="nav-item" onclick="openSec('ref')">ğŸ‘¥<br>REFERAL</div>
        <div class="nav-item" onclick="openSec('leader')">ğŸ“Š<br>REYTING</div>
        <div class="nav-item" onclick="openSec('boost')">âš¡<br>BOOSTER</div>
        <div class="nav-item" onclick="openSec('home')">ğŸ <br>UYIM</div>
    </div>

    <script>
        // Firebase Config (O'zingiznikini qo'ying)
        const firebaseConfig = { apiKey: "AIza...", databaseURL: "https://your-db.firebaseio.com" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        const tg = window.Telegram.WebApp;
        const user = tg.initDataUnsafe.user || { id: "7462622808", first_name: "Diyorbek" };
        
        let s = { coins: 0, diamonds: 0, energy: 500, maxE: 500, power: 1, hourly: 0, pCost: 500, hCost: 1000, eCost: 2000, refs: 0, refPending: 0, spinLimit: 0 };

        function init() {
            tg.expand();
            document.getElementById('h-name').innerText = user.first_name;
            document.getElementById('h-id').innerText = user.id;
            document.getElementById('my-name').innerText = user.first_name;
            document.getElementById('ref-url').innerText = "t.me/OltinTanga1_bot?start=" + user.id;

            // Musiqa: Birinchi tapda chalish
            document.body.addEventListener('click', () => { 
                const music = document.getElementById('bg-music');
                if(music.paused) music.play().catch(()=>{}); 
            }, {once: true});

            loadData();
            setInterval(gameLoop, 1000);
        }

        function gameLoop() {
            s.coins += (s.hourly / 3600);
            if(s.energy < s.maxE) s.energy += 0.5;
            updateUI();
            updateTanga();
        }

        function updateTanga() {
            const t = document.getElementById('tanga');
            t.innerText = s.power; // Tanga ichida tap kuchi
            if(s.coins >= 5000000) t.style.background = "black";
            else if(s.coins >= 1000000) t.style.background = "purple";
            else if(s.coins >= 500000) t.style.background = "blue";
            else if(s.coins >= 100000) t.style.background = "green";
            else if(s.coins >= 50000) t.style.background = "red";
        }

        function handleTap(e) {
            if(s.energy >= s.power) {
                s.coins += s.power;
                s.energy -= s.power;
                saveData();
                updateUI();
            }
        }

        function exchange() {
            let val = parseInt(document.getElementById('m-input').value);
            if(val >= 1000 && s.coins >= val) {
                s.coins -= val;
                s.diamonds += Math.floor(val / 1000);
                saveData();
                alert("Almashtirildi! ğŸ’");
            } else { alert("Mablag' yetarli emas!"); }
        }

        function buy(type) {
            if(type==='p' && s.coins >= s.pCost) { s.coins -= s.pCost; s.power++; s.pCost *= 2; }
            if(type==='h' && s.coins >= s.hCost) { s.coins -= s.hCost; s.hourly += 100; s.hCost *= 2; }
            if(type==='e' && s.coins >= s.eCost) { s.coins -= s.eCost; s.maxE += 500; s.eCost *= 2; }
            saveData();
        }

        function claimRef() {
            if(s.refPending > 0) {
                s.coins += s.refPending;
                s.refPending = 0;
                saveData();
            }
        }

        function updateUI() {
            document.getElementById('c-ui').innerText = Math.floor(s.coins).toLocaleString();
            document.getElementById('d-ui').innerText = s.diamonds;
            document.getElementById('e-text').innerText = Math.floor(s.energy) + " / " + s.maxE;
            document.getElementById('energy-fill').style.width = (s.energy/s.maxE*100) + "%";
            document.getElementById('h-ui').innerText = s.hourly;
            document.getElementById('p-ui').innerText = s.power;
            document.getElementById('p-cost').innerText = s.pCost + " ğŸ’°";
            document.getElementById('h-cost').innerText = s.hCost + " ğŸ’°";
            document.getElementById('e-cost').innerText = s.eCost + " ğŸ’°";
            document.getElementById('ref-count').innerText = s.refs;
            document.getElementById('ref-money').innerText = s.refPending.toLocaleString();
            document.getElementById('h-c').innerText = Math.floor(s.coins).toLocaleString();
            document.getElementById('h-d').innerText = s.diamonds;
            document.getElementById('my-score').innerText = Math.floor(s.coins).toLocaleString();
        }

        function openSec(id) { closeAll(); document.getElementById(id + '-sec').classList.add('active'); }
        function closeAll() { document.querySelectorAll('.section').forEach(sec => sec.classList.remove('active')); }

        function saveData() { db.ref('users/' + user.id).update(s); }
        function loadData() {
            db.ref('users/' + user.id).once('value', (snap) => {
                if(snap.exists()) { s = {...s, ...snap.val()}; updateUI(); }
            });
        }

        init();
    </script>
</body>
                                                                                 </html>

    
    
    
                                                                                              

        

    
                                                           </html>
            
                                                      
                

