<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Oltin Tanga Pro</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://alwingulla.com/tag.min.js" data-zone="10558007" async></script>
    
    <style>
        :root { --bg: #050810; --accent: #f59e0b; --card: #111827; }
        body { background: var(--bg); color: white; font-family: 'Segoe UI', sans-serif; margin: 0; padding-bottom: 100px; text-align: center; user-select: none; overflow: hidden; }
        
        /* Stats Panel */
        .header-stats { display: flex; justify-content: space-around; padding: 12px; background: rgba(0,0,0,0.6); border-bottom: 1px solid #1e293b; }
        .stat-box { background: #1a1f2e; border: 1px solid #374151; border-radius: 10px; flex: 1; margin: 0 4px; padding: 5px; }
        .stat-label { font-size: 9px; color: #9ca3af; display: block; }
        .stat-value { font-size: 13px; font-weight: bold; color: var(--accent); }

        /* Main Game Area */
        .total-coins { font-size: 50px; font-weight: 900; color: #facc15; margin: 20px 0 5px; text-shadow: 0 0 15px rgba(250,204,21,0.3); }
        .diamond-ui { color: #00d4ff; font-weight: bold; margin-bottom: 15px; }
        
        .tanga-container { position: relative; height: 260px; display: flex; align-items: center; justify-content: center; }
        .main-tanga { 
            width: 210px; height: 210px; border-radius: 50%; 
            background: radial-gradient(circle, #facc15 0%, #ca8a04 100%); 
            border: 10px solid #854d0e; display: flex; align-items: center; justify-content: center; 
            font-size: 70px; font-weight: 900; color: white; transition: 0.1s; z-index: 5;
        }
        .main-tanga:active { transform: scale(0.92); }

        /* Side Buttons */
        .side-btn { position: absolute; width: 55px; height: 55px; border-radius: 50%; background: #111; border: 2px solid var(--accent); display: flex; align-items: center; justify-content: center; font-size: 25px; z-index: 10; cursor: pointer; }
        .btn-daily { left: 30px; } .btn-spin { right: 30px; background: conic-gradient(red, yellow, green, blue, red); }

        /* Sections */
        .section { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--bg); z-index: 2000; padding: 25px; box-sizing: border-box; overflow-y: auto; }
        .section.active { display: block; }
        .card { background: var(--card); padding: 15px; border-radius: 16px; margin-bottom: 12px; border: 1px solid #374151; text-align: left; }
        
        .btn-action { background: var(--accent); color: black; border: none; padding: 12px; border-radius: 10px; font-weight: bold; width: 100%; cursor: pointer; margin-top: 5px; }
        .btn-close { background: #374151; color: white; margin-top: 10px; }

        /* Nav Bar */
        .nav-bar { position: fixed; bottom: 0; width: 100%; background: #0f172a; display: flex; justify-content: space-around; padding: 12px 0; border-top: 1px solid #1e293b; z-index: 1000; }
        .nav-item { flex: 1; font-size: 10px; color: #94a3b8; }
    </style>
</head>
<body>
    <audio id="bg-music" loop src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3"></audio>

    <div id="main-ui">
        <div class="header-stats">
            <div class="stat-box"><span class="stat-label">STATUS</span><span id="st-ui" class="stat-value">Bronza</span></div>
            <div class="stat-box"><span class="stat-label">SOATIGA</span><span id="h-ui" class="stat-value">0</span></div>
            <div class="stat-box"><span class="stat-label">ENERGY</span><span id="e-val" class="stat-value">500</span></div>
        </div>

        <div class="total-coins" id="c-ui">0</div>
        <div class="diamond-ui">ğŸ’ <span id="d-ui">0</span></div>

        <div class="tanga-container">
            <div class="side-btn btn-daily" onclick="openSec('daily-sec')">ğŸ</div>
            <div id="tanga" class="main-tanga" onclick="handleTap(event)">1</div>
            <div class="side-btn btn-spin" onclick="openSec('spin-sec')">ğŸ¡</div>
        </div>
        <p>Tap kuchi: <b id="p-ui">1</b></p>
    </div>

    <div id="market-sec" class="section">
        <h2>ğŸ›’ Market</h2>
        <div class="card">
            <p>1,000 Tanga = 1 Olmos ğŸ’</p>
            <input type="number" id="m-input" style="width:90%; padding:10px; margin-bottom:10px;" placeholder="Tanga miqdorini yozing">
            <button class="btn-action" onclick="exchange()">ALMASHTIRISH</button>
        </div>
        <button class="btn-action btn-close" onclick="closeAll()">YOPISH</button>
    </div>

    <div id="ref-sec" class="section">
        <h2>ğŸ‘¥ Referal</h2>
        <div class="card">Do'stlar: <b id="ref-count">0</b> | Bonus: <b id="ref-money">0</b> ğŸ’°</div>
        <button class="btn-action" onclick="claimRef()">OLISH</button>
        <div class="card" id="ref-link" style="font-size:11px; color:var(--accent); margin-top:10px;"></div>
        <button class="btn-action btn-close" onclick="closeAll()">YOPISH</button>
    </div>

    <div id="leader-sec" class="section">
        <h2>ğŸ“Š Leaderboard</h2>
        <div id="leader-list"></div>
        <button class="btn-action btn-close" onclick="closeAll()">YOPISH</button>
    </div>

    <div id="home-sec" class="section">
        <h2>ğŸ  Mening Uyim</h2>
        <div class="card">Foydalanuvchi: <b id="h-name">...</b><br>ID: <b id="h-id">...</b></div>
        <div class="card">ğŸ’° Balans: <span id="h-c">0</span><br>ğŸ’ Olmoslar: <span id="h-d">0</span></div>
        <button class="btn-action" style="background:linear-gradient(to right, #7c3aed, #db2777); color:white" onclick="alert('Tez kunda! Tonga almashtirilish boshlandi.')">ğŸš€ AIRDROP</button>
        <button class="btn-action btn-close" onclick="closeAll()">YOPISH</button>
    </div>

    <div id="spin-sec" class="section">
        <h2>ğŸ¡ Tasodifiy Tanga</h2>
        <div class="card">Limit: <span id="spin-limit-ui">0</span> / 4</div>
        <button class="btn-action" id="spin-btn" onclick="handleSpin()">OMADNI SINASH</button>
        <button class="btn-action btn-close" onclick="closeAll()">YOPISH</button>
    </div>

    <div id="daily-sec" class="section">
        <h2>ğŸ Kunlik Bonus</h2>
        <div class="card">5,000 ğŸ’° olishingiz mumkin. Reklama bilan 2x (10,000 ğŸ’°) qilsa bo'ladi!</div>
        <button class="btn-action" onclick="claimDaily(false)">ODDIY OLISH (5k)</button>
        <button class="btn-action" style="background:orange" onclick="claimDaily(true)">REKLAMA BILAN (10k)</button>
        <button class="btn-action btn-close" onclick="closeAll()">YOPISH</button>
    </div>

    <div class="nav-bar">
        <div class="nav-item" onclick="openSec('market-sec')">ğŸ›’<br>MARKET</div>
        <div class="nav-item" onclick="openSec('ref-sec')">ğŸ‘¥<br>REFERAL</div>
        <div class="nav-item" onclick="openSec('leader-sec')">ğŸ“Š<br>REYTING</div>
        <div class="nav-item" onclick="openSec('home-sec')">ğŸ <br>UYIM</div>
    </div>

    <script>
        // 1. Firebase Sozlamalari (O'zingiznikini qo'ying)
        const firebaseConfig = { apiKey: "AIza...", databaseURL: "https://your-db-url.firebaseio.com" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        const tg = window.Telegram.WebApp;
        const user = tg.initDataUnsafe.user || { id: "7462622808", first_name: "Ganiyev Diyorbek" };
        
        let s = { coins: 0, diamonds: 0, energy: 500, maxE: 500, power: 1, hourly: 0, refs: 0, refPending: 0, spinCount: 0, lastSpinDate: "", lastDaily: 0 };

        function init() {
            tg.expand();
            document.getElementById('h-name').innerText = user.first_name;
            document.getElementById('h-id').innerText = user.id;
            document.getElementById('ref-link').innerText = "t.me/OltinTanga1_bot?start=" + user.id;
            
            document.body.addEventListener('click', () => { 
                const m = document.getElementById('bg-music');
                if(m.paused) m.play().catch(()=>{}); 
            }, {once: true});

            loadFromFirebase();
            setInterval(loop, 1000);
        }

        function loop() {
            s.coins += (s.hourly / 3600);
            if(s.energy < s.maxE) s.energy += 0.5;
            updateUI();
            updateTangaVisual();
        }

        function handleTap(e) {
            if(s.energy >= s.power) {
                s.coins += s.power;
                s.energy -= s.power;
                saveToFirebase();
                updateUI();
            }
        }

        function claimDaily(withAd) {
            let now = Date.now();
            if(now - s.lastDaily < 86400000) return alert("Ertaga qayting!");

            if(withAd) {
                if(window.show_10558007) {
                    window.show_10558007().then(() => { finishDaily(10000); });
                } else { alert("Reklama yuklanmadi!"); }
            } else { finishDaily(5000); }
        }

        function finishDaily(amt) {
            s.coins += amt; s.lastDaily = Date.now();
            saveToFirebase(); alert(amt + " ğŸ’° olindi!");
        }

        async function handleSpin() {
            let today = new Date().toISOString().slice(0, 10);
            if(s.lastSpinDate !== today) { s.spinCount = 0; s.lastSpinDate = today; }

            if(s.spinCount >= 4) return alert("Limit tugadi!");

            if(s.spinCount === 0) { executeSpin(); } 
            else {
                if(window.show_10558007) {
                    window.show_10558007().then(() => { executeSpin(); });
                } else { alert("Reklama yo'q!"); }
            }
        }

        function executeSpin() {
            let win = Math.floor(Math.random() * 4900) + 100;
            s.coins += win; s.spinCount++;
            saveToFirebase(); alert("Yutuq: " + win + " ğŸ’°");
        }

        function exchange() {
            let v = parseInt(document.getElementById('m-input').value);
            if(v >= 1000 && s.coins >= v) {
                s.coins -= v; s.diamonds += Math.floor(v/1000);
                saveToFirebase(); alert("Muvaffaqiyatli!");
            }
        }

        function updateTangaVisual() {
            const t = document.getElementById('tanga');
            t.innerText = s.power;
            if(s.coins >= 5000000) t.style.background = "black";
            else if(s.coins >= 1000000) t.style.background = "purple";
            else if(s.coins >= 500000) t.style.background = "blue";
            else if(s.coins >= 100000) t.style.background = "green";
            else if(s.coins >= 50000) t.style.background = "red";
        }

        function updateUI() {
            document.getElementById('c-ui').innerText = Math.floor(s.coins).toLocaleString();
            document.getElementById('d-ui').innerText = s.diamonds;
            document.getElementById('e-val').innerText = Math.floor(s.energy) + " / " + s.maxE;
            document.getElementById('p-ui').innerText = s.power;
            document.getElementById('h-ui').innerText = s.hourly;
            document.getElementById('h-c').innerText = Math.floor(s.coins).toLocaleString();
            document.getElementById('h-d').innerText = s.diamonds;
            document.getElementById('spin-limit-ui').innerText = s.spinCount;
            document.getElementById('ref-count').innerText = s.refs;
            document.getElementById('ref-money').innerText = s.refPending;
        }

        function saveToFirebase() {
            db.ref('users/' + user.id).set(s);
            db.ref('leaderboard/' + user.id).set({name: user.first_name, coins: Math.floor(s.coins)});
        }

        function loadFromFirebase() {
            db.ref('users/' + user.id).once('value', (snap) => {
                if(snap.exists()) { s = {...s, ...snap.val()}; updateUI(); }
            });
            db.ref('leaderboard').orderByChild('coins').limitToLast(10).on('value', (snap) => {
                let h = ""; let list = [];
                snap.forEach(c => list.push(c.val()));
                list.reverse().forEach((p, i) => {
                    h += `<div class="card">${i+1}. ${p.name} <span style="float:right">${p.coins.toLocaleString()}</span></div>`;
                });
                document.getElementById('leader-list').innerHTML = h;
            });
        }

        function openSec(id) { closeAll(); document.getElementById(id).classList.add('active'); }
        function closeAll() { document.querySelectorAll('.section').forEach(x => x.classList.remove('active')); }

        init();
    </script>
</body>
                          </html>
                                        
                                                                                 </html>

    
    
    
                                                                                              

        

    
                                                           </html>
            
                                                      
                

