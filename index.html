<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Oltin Tanga Ultra</title>
    
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>

    <script src='https://alwingulla.com/88/p.js' async data-ahasid='10558007'></script>

    <style>
        :root { --gold: #fbc531; --bg: #0c111c; --card: #1c2230; --btn: #fbc531; --green: #4cd137; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; margin:0; padding:0; font-family: 'Segoe UI', sans-serif; }
        
        body { background: var(--bg); color: white; height: 100vh; overflow: hidden; display: flex; flex-direction: column; transition: 1s ease; }

        /* Dinamik Fonlar */
        body.lvl-1 { background: #0c111c; }
        body.lvl-2 { background: #0a3d62; }
        body.lvl-3 { background: #1b1464; }
        body.lvl-4 { background: #440000; }
        body.lvl-5 { background: #1b5e20; }

        /* Loading */
        #loader { position: fixed; inset:0; background:#000; z-index:9999; display:flex; flex-direction:column; align-items:center; justify-content:center; }
        .spin { width:40px; height:40px; border:4px solid #222; border-top-color:var(--gold); border-radius:50%; animation: s 1s linear infinite; }
        @keyframes s { to { transform: rotate(360deg); } }

        /* Header & Airdrop Timer */
        .air-header { background: rgba(0,0,0,0.4); padding: 10px; text-align: center; border-bottom: 1px solid #333; }
        .air-timer { font-size: 18px; font-weight: 900; color: var(--gold); }

        .top-stats { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; padding: 10px; }
        .stat-card { background: var(--card); border-radius: 12px; padding: 8px; text-align: center; border: 1px solid #333; }

        /* Main Game */
        .main-ui { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .balance { font-size: 50px; font-weight: 900; color: var(--gold); }
        
        .coin-wrapper { width: 240px; height: 240px; position: relative; }
        .coin { width: 100%; height: 100%; border-radius: 50%; border: 8px solid #8a6200; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: 0.1s; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .coin:active { transform: scale(0.92); }
        
        /* Nav */
        .navbar { display: flex; background: #0a0e17; padding: 12px 0; border-top: 1px solid #222; }
        .nav-item { flex: 1; text-align: center; font-size: 10px; color: #888; cursor: pointer; }

        /* Pages */
        .page { position: fixed; inset: 0; background: var(--bg); z-index: 1000; padding: 20px; display: none; overflow-y: auto; }
        .p-head { display: flex; justify-content: space-between; margin-bottom: 20px; font-size: 20px; }

        /* Card Style (Skrinshotdagi kabi) */
        .card-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .upgrade-card { background: var(--card); border: 1px solid #333; border-radius: 15px; padding: 15px; text-align: center; }
        .upgrade-card img { width: 40px; margin-bottom: 5px; }
        .upgrade-card h4 { font-size: 14px; margin: 5px 0; }
        .upgrade-card p { font-size: 12px; color: var(--green); margin-bottom: 8px; }
        .upgrade-btn { background: var(--gold); border: none; width: 100%; padding: 8px; border-radius: 10px; font-weight: bold; display: flex; align-items: center; justify-content: center; gap: 5px; }

        /* Aviator */
        #av-box { background: #000; height: 180px; position: relative; border-radius: 10px; overflow: hidden; border: 1px solid #333; margin-top: 10px; }
        #rocket { position: absolute; bottom: 10px; left: 10%; font-size: 30px; transition: 0.1s; }
        
        /* Rank */
        .rank-item { background: rgba(251,197,49,0.1); border: 1px solid rgba(251,197,49,0.3); padding: 12px; border-radius: 12px; display: flex; justify-content: space-between; margin-bottom: 8px; align-items: center; }
    </style>
</head>
<body class="lvl-1">

<div id="loader"><div class="spin"></div><p>Yuklanmoqda...</p></div>

<div class="air-header">
    <small>ğŸš€ AIRDROP COUNTDOWN</small>
    <div class="air-timer" id="air-timer">99 Kun 00:00:00</div>
</div>

<div class="top-stats">
    <div class="stat-card"><small>Mining ğŸ“€</small><b id="st-pph">0/s</b></div>
    <div class="stat-card"><small>Mining ğŸ’</small><b id="st-dph">0/s</b></div>
</div>

<div class="main-ui">
    <h1 class="balance" id="st-bal">0</h1>
    <div style="color: #00d2ff; font-weight: bold; margin-bottom: 15px;">ğŸ’ <span id="st-diam">0</span></div>
    <div class="coin-wrapper" onclick="handleTap(event)">
        <div class="coin" id="main-coin"><span id="st-tap-val" style="font-size:40px; font-weight:900;">+1</span></div>
    </div>
    <div style="margin-top:20px;">âš¡ <b id="st-en">5000/5000</b></div>
</div>

<div class="navbar">
    <div class="nav-item" onclick="openP('p-shop')">ğŸ›’ Kartalar</div>
    <div class="nav-item" onclick="openP('p-bonus')">ğŸ Bonus</div>
    <div class="nav-item" onclick="openP('p-games')">ğŸ® O'yinlar</div>
    <div class="nav-item" onclick="openP('p-rank')">ğŸ† Reyting</div>
    <div class="nav-item" onclick="openP('p-prof')">ğŸ‘¤ Profil</div>
</div>

<div id="p-shop" class="page">
    <div class="p-head"><b>Upgrade Kartalar</b> <span onclick="closeP('p-shop')">Ã—</span></div>
    <div class="card-grid" id="shop-list"></div>
</div>

<div id="p-bonus" class="page">
    <div class="p-head"><b>Bonus Bo'limi</b> <span onclick="closeP('p-bonus')">Ã—</span></div>
    <div class="upgrade-card" style="margin-bottom:15px; padding:20px;">
        <h3>Super Tap ğŸ”¥</h3>
        <p>30 sek: Tap=1000 & No Energy</p>
        <div id="super-timer" style="color:var(--gold)">Tayyor!</div>
        <button onclick="ad('super')" id="btn-super" class="upgrade-btn" style="margin-top:10px">REKLAMA VA YOQISH</button>
    </div>
    <div class="upgrade-card" style="padding:20px;">
        <h3>Omadli Sandiq ğŸ</h3>
        <p>0-15K Tanga yoki 10-100 Olmos</p>
        <div id="chest-timer" style="color:var(--gold)">Tayyor!</div>
        <button onclick="ad('chest')" id="btn-chest" class="upgrade-btn" style="margin-top:10px">REKLAMA VA OCHISH</button>
    </div>
</div>

<div id="p-games" class="page">
    <div class="p-head"><b>Mini O'yinlar</b> <span onclick="closeP('p-games')">Ã—</span></div>
    <div id="av-box">
        <h2 id="av-x" style="text-align:center; margin-top:50px; font-size:40px; color:var(--gold);">1.00x</h2>
        <div id="rocket">ğŸš€</div>
    </div>
    <div id="av-hist" style="display:flex; gap:5px; margin-top:5px; overflow-x:auto;"></div>
    <div style="display:flex; gap:10px; margin-top:10px;">
        <button id="av-start" onclick="ad('av')" class="upgrade-btn" style="background:var(--green)">BET (1000)</button>
        <button id="av-cash" onclick="cashAv()" class="upgrade-btn" style="display:none">CASHOUT</button>
    </div>
    <hr style="margin:20px 0; opacity:0.1;">
    <h3>ğŸ§© Puzzle 25 (2 min)</h3>
    <div id="puz-grid" style="display:grid; grid-template-columns:repeat(5,1fr); gap:2px; margin-top:10px;"></div>
    <div id="puz-timer" style="text-align:center; margin-top:10px; color:red;"></div>
    <button id="puz-btn" onclick="ad('puz')" class="upgrade-btn" style="margin-top:10px">O'YINNI BOSHLASH</button>
</div>

<div id="p-rank" class="page">
    <div class="p-head"><b>Global Reyting</b> <span onclick="closeP('p-rank')">Ã—</span></div>
    <div id="rank-list"></div>
</div>

<div id="p-prof" class="page">
    <div class="p-head"><b>Profil</b> <span onclick="closeP('p-prof')">Ã—</span></div>
    <div class="upgrade-card" style="text-align:left; line-height:1.8;">
        <p>ğŸ‘¤ Ism: <b id="pr-name">...</b></p>
        <p>ğŸ†” ID: <span id="pr-id">...</span></p>
        <p>ğŸ“€ Tangalar: <b id="pr-c">0</b></p>
        <p>ğŸ’ Olmoslar: <b id="pr-d">0</b></p>
        <p>â­ Daraja: <b id="pr-lvl">1</b></p>
        <hr style="opacity:0.1; margin:10px 0;">
        <h3>ğŸ”— TON HAMYON</h3>
        <div id="ton-btn"></div>
        <hr style="opacity:0.1; margin:10px 0;">
        <h4>Savol-Javoblar (FAQ)</h4>
        <p style="font-size:11px; color:#888;">
            - Tanga qanday yig'iladi? Kartalarni upgrade qiling.<br>
            - Airdrop qachon? 99 kundan so'ng daraja va olmosga qarab.<br>
            - Hamyonni nega ulaymiz? Tokenlarni qabul qilish uchun.
        </p>
    </div>
</div>

<script>
// --- FIREBASE CONFIG (Sizniki) ---
const firebaseConfig = {
  apiKey: "AIzaSyDbttlr-oGJeDbjMbrubcuspgg9gk-7Gxs",
  authDomain: "oltin-tanga-d2c80.firebaseapp.com",
  databaseURL: "https://oltin-tanga-d2c80-default-rtdb.firebaseio.com",
  projectId: "oltin-tanga-d2c80",
  storageBucket: "oltin-tanga-d2c80.firebasestorage.app",
  messagingSenderId: "954210050924",
  appId: "1:954210050924:web:f57b75568c66216c49c949"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();
const tg = window.Telegram.WebApp;
const user = tg.initDataUnsafe?.user || { id: "TEST_ID", first_name: "O'yinchi" };

let s = { c:0, d:0, pph:0, dph:0, e:5000, tap:1, tab:1, sLast:0, cLast:0, pLast:0 };
let isSuper = false;

// --- REKLAMA ---
function ad(type) {
    if(typeof show_10558007 === 'function') {
        show_10558007().then(() => reward(type));
    } else {
        reward(type); // Test uchun
    }
}

function reward(type) {
    if(type === 'super') { isSuper=true; s.tap=1000; s.sLast=Date.now()+900000; setTimeout(()=>{isSuper=false; s.tap=1; updateUI();}, 30000); }
    if(type === 'chest') { 
        let tc = Math.floor(Math.random()*15000); let td = Math.floor(Math.random()*90)+10;
        s.c+=tc; s.d+=td; s.cLast=Date.now()+1500000; alert(tc+" tanga va "+td+" olmos!"); 
    }
    if(type === 'av') startAv();
    if(type === 'puz') startPuz();
    if(type === 'energy') { s.e=5000; updateUI(); }
}

// --- CORE ---
function init() {
    db.ref('users/'+user.id).once('value', snap => {
        if(snap.val()) s = {...s, ...snap.val()};
        document.getElementById('loader').style.display = 'none';
        updateUI(); renderShop();
        setInterval(loop, 1000);
        setInterval(save, 10000);
    });
}

function loop() {
    s.c += (s.pph/3600); s.d += (s.dph/3600);
    if(s.e < 5000 && !isSuper) s.e = Math.min(5000, s.e+2);
    updateUI(); timers();
}

function handleTap(e) {
    if(s.e >= s.tap || isSuper) {
        s.c += s.tap; if(!isSuper) s.e -= s.tap;
        updateUI();
    } else { ad('energy'); }
}

function updateUI() {
    document.getElementById('st-bal').innerText = Math.floor(s.c).toLocaleString();
    document.getElementById('st-diam').innerText = Math.floor(s.d).toLocaleString();
    document.getElementById('st-pph').innerText = Math.floor(s.pph)+"/s";
    document.getElementById('st-dph').innerText = Math.floor(s.dph)+"/s";
    document.getElementById('st-en').innerText = Math.floor(s.e)+"/5000";
    document.getElementById('st-tap-val').innerText = "+"+s.tap;
    
    // Profil
    document.getElementById('pr-name').innerText = user.first_name;
    document.getElementById('pr-id').innerText = user.id;
    document.getElementById('pr-c').innerText = Math.floor(s.c).toLocaleString();
    document.getElementById('pr-d').innerText = Math.floor(s.d).toLocaleString();
    document.getElementById('pr-lvl').innerText = s.tab;

    document.body.className = "lvl-" + s.tab;
    
    // Tanga rangi
    let colors = ['#8a6200','#00a8ff','#4834d4','#6d0000','#006400'];
    document.getElementById('main-coin').style.borderColor = colors[s.tab-1] || '#8a6200';
}

// --- SHOP ---
const cardData = [
    {n:"Bolg'a", p:500, inc:10, img:"ğŸ”¨"}, {n:"Kurak", p:2000, inc:50, img:"â›ï¸"},
    {n:"Xalta", p:5000, inc:150, img:"ğŸ’°"}, {n:"Araba", p:10000, inc:350, img:"ğŸ›’"},
    {n:"G'alvir", p:25000, inc:900, img:"ğŸ”"}, {n:"Konchi", p:60000, inc:2500, img:"ğŸ‘·"},
    {n:"Olmos Miner 1", p:150000, inc:10, type:'d', img:"ğŸ’"}, {n:"Olmos Miner 2", p:500000, inc:50, type:'d', img:"ğŸ’"}
];

function renderShop() {
    let h = '';
    cardData.forEach((c, i) => {
        let cost = Math.floor(c.p * Math.pow(1.5, (s.items?.[i] || 0)));
        h += `<div class="upgrade-card">
            <div style="font-size:30px">${c.img}</div>
            <h4>${c.n}</h4>
            <p>+${c.inc}/${c.type=='d'?'d':'s'}</p>
            <button class="upgrade-btn" onclick="buy(${i},${cost})">ğŸ“€ ${cost.toLocaleString()}</button>
        </div>`;
    });
    document.getElementById('shop-list').innerHTML = h;
}

function buy(id, cost) {
    if(s.c >= cost) {
        s.c -= cost;
        if(!s.items) s.items = {};
        s.items[id] = (s.items[id] || 0) + 1;
        if(cardData[id].type == 'd') s.dph += cardData[id].inc; else s.pph += cardData[id].inc;
        if(id > 4 && s.tab < 5) s.tab++;
        updateUI(); renderShop(); save();
    }
}

// --- AVIATOR ---
let avX = 1.0, avI;
function startAv() {
    if(s.c < 1000) return alert("Kamida 1000 tanga!");
    s.c -= 1000; document.getElementById('av-start').style.display='none'; document.getElementById('av-cash').style.display='block';
    avX = 1.0; let crash = (Math.random()*20 + 1).toFixed(2);
    avI = setInterval(() => {
        avX += 0.01; document.getElementById('av-x').innerText = avX.toFixed(2)+"x";
        document.getElementById('rocket').style.left = (10 + avX*2) + "%";
        if(avX >= crash) { clearInterval(avI); alert("PORTLADI!"); resAv(); }
    }, 100);
}
function cashAv() { clearInterval(avI); s.c += (1000*avX); alert(Math.floor(1000*avX)+" yutdingiz!"); resAv(); }
function resAv() {
    document.getElementById('av-start').style.display='block'; document.getElementById('av-cash').style.display='none';
    let h = document.createElement('span'); h.innerText = avX.toFixed(2)+"x "; h.style.color = avX > 2 ? 'var(--green)' : 'red';
    document.getElementById('av-hist').prepend(h);
}

// --- PUZZLE ---
function startPuz() {
    if(Date.now() < s.pLast) return;
    let g = document.getElementById('puz-grid'); g.innerHTML = '';
    let items = ["ğŸ ","ğŸŒ³","ğŸš—","ğŸ","ğŸ¶","ğŸ±","ğŸŒ™","â­","ğŸ”¥","ğŸ","ğŸ ","ğŸŒ³","ğŸš—","ğŸ","ğŸ¶","ğŸ±","ğŸŒ™","â­","ğŸ ","ğŸŒ³","ğŸš—","ğŸ","ğŸ¶","ğŸ±","ğŸŒ™"];
    items.sort(() => Math.random() - 0.5).forEach(e => {
        let t = document.createElement('div'); t.innerText=e;
        t.style.cssText = "background:var(--card); aspect-ratio:1; display:flex; align-items:center; justify-content:center; border:1px solid #333; font-size:18px;";
        g.appendChild(t);
    });
    setTimeout(() => { s.c += 100000; s.pLast = Date.now() + 1800000; g.innerHTML = ''; alert("Puzzle tugadi! 100,000 yutuq!"); }, 120000);
}

// --- RANK ---
function loadRank() {
    db.ref('users').orderByChild('c').limitToLast(20).once('value', snap => {
        let l = document.getElementById('rank-list'); l.innerHTML = '';
        let list = []; snap.forEach(u => list.push(u.val()));
        list.reverse().forEach((p, i) => {
            let m = i==0?'ğŸ¥‡':i==1?'ğŸ¥ˆ':i==2?'ğŸ¥‰':(i+1);
            l.innerHTML += `<div class="rank-item">
                <span><b>${m}</b> ${p.first_name || 'User'} (Lvl:${p.tab})</span>
                <span>${Math.floor(p.c).toLocaleString()} ğŸ“€ | ${Math.floor(p.d)} ğŸ’</span>
            </div>`;
        });
    });
}

// --- HELPERS ---
function timers() {
    let now = Date.now();
    document.getElementById('btn-super').disabled = now < s.sLast;
    document.getElementById('super-timer').innerText = now < s.sLast ? Math.ceil((s.sLast-now)/1000/60)+" min" : "Tayyor!";
    document.getElementById('btn-chest').disabled = now < s.cLast;
    document.getElementById('chest-timer').innerText = now < s.cLast ? Math.ceil((s.cLast-now)/1000/60)+" min" : "Tayyor!";
    
    let diff = new Date("2026-05-20") - now;
    document.getElementById('air-timer').innerText = Math.floor(diff/(1000*60*60*24)) + " Kun " + new Date(diff).toISOString().substr(11,8);
}

function openP(id) { if(id=='p-rank') loadRank(); document.getElementById(id).style.display='block'; }
function closeP(id) { document.getElementById(id).style.display='none'; }
function save() { s.first_name = user.first_name; db.ref('users/'+user.id).update(s); }

init();
</script>

<script>
const tonUI = new TON_CONNECT_UI.TonConnectUI({
    manifestUrl: 'https://ganiyevdiyorbek700-dotcom.github.io/Oltin-Tanga-/tonconnect-manifest.json',
    buttonRootId: 'ton-btn'
});
</script>
</body>
    </html>
        
            
        
                                               
    
            
        
        
    
        
    
    
            
                
            
    
        
        
    
        
                                                       
        
                                    
        
        
    
                                        
                                                                     
        
    
                                                              
            
    
            
            
                                                      
                

