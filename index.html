
<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Tanha Empire | Official</title>
    
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
    <script src="//libtl.com/sdk.js" data-zone="10558007" data-sdk="show_10558007"></script>

    <style>
        :root { --main: #fbc531; --bg: #0b0d10; --card: #1c1f24; --text: #ffffff; }
        body { background: var(--bg); color: var(--text); font-family: 'Segoe UI', sans-serif; margin: 0; padding: 0; overflow: hidden; }
        
        /* Yuqori qism (Balans) */
        .header { background: #16191d; padding: 20px; display: flex; justify-content: space-around; border-bottom: 2px solid var(--main); font-weight: bold; font-size: 20px; }
        .coin-icon { color: var(--main); margin-right: 5px; }

        /* Asosiy ekran */
        .content { height: 75vh; overflow-y: auto; padding-bottom: 80px; text-align: center; }
        .page { display: none; padding: 20px; animation: fadeIn 0.3s; }
        .active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* Tanga fizikasi */
        .coin-box { margin: 40px auto; width: 220px; height: 220px; position: relative; }
        .main-coin { 
            width: 100%; height: 100%; background: radial-gradient(circle, #fbc531, #e1b12c); 
            border-radius: 50%; display: flex; align-items: center; justify-content: center; 
            font-size: 80px; cursor: pointer; border: 8px solid #9c7c25;
            box-shadow: 0 0 40px rgba(251, 197, 49, 0.4); transition: transform 0.1s;
        }
        .main-coin:active { transform: scale(0.92); }

        /* Kartalar */
        .card { background: var(--card); border-radius: 15px; padding: 15px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center; border: 1px solid #2d323a; }
        .btn-buy { background: var(--main); border: none; padding: 10px 15px; border-radius: 8px; font-weight: bold; color: #000; cursor: pointer; }
        
        /* Pastki menyu */
        .nav { position: fixed; bottom: 0; width: 100%; background: #16191d; display: flex; padding: 12px 0; border-top: 1px solid #2d323a; }
        .nav-item { flex: 1; font-size: 11px; color: #6c757d; cursor: pointer; }
        .nav-item.active { color: var(--main); }
        .nav-item b { display: block; font-size: 20px; margin-bottom: 3px; font-style: normal; }

        /* Reyting stili */
        .rank-item { padding: 10px; border-bottom: 1px solid #2d323a; display: flex; justify-content: space-between; }
    </style>
</head>
<body>

<div class="header">
    <div><span class="coin-icon">üìÄ</span> <span id="u-bal">0</span></div>
    <div style="color: #4cd137;">üíé <span id="u-diam">0</span></div>
</div>

<div class="content">
    <div id="p-home" class="page active">
        <div id="evo-name" style="color:var(--main); font-weight:bold; margin-top:10px;">DARAXT BOSHQARUVCHISI</div>
        <div class="coin-box">
            <div class="main-coin" id="coin-btn" onclick="tap(event)">üìÄ</div>
        </div>
        <p>LVL: <span id="u-lvl">1</span> | Tap: +<span id="u-pwr">1</span></p>
    </div>

    <div id="p-shop" class="page">
        <h3>Evolyutsiya Kartalari</h3>
        <div id="shop-list"></div>
    </div>

    <div id="p-rank" class="page">
        <h3>TOP 10 Imperiya</h3>
        <div id="rank-list"></div>
    </div>

    <div id="p-bonus" class="page">
        <h3>Bepul Bonuslar</h3>
        <div class="card" onclick="ad()">
            <div><b>üì∫ Reklama</b><br><small>+5,000 tanga</small></div>
            <button class="btn-buy">KO'RISH</button>
        </div>
        <div class="card" onclick="daily()">
            <div><b>üìÖ Kunlik</b><br><small>+10,000 tanga</small></div>
            <button class="btn-buy">OLISH</button>
        </div>
    </div>

    <div id="p-prof" class="page">
        <h3>Sizning Profilingiz</h3>
        <div id="ton-connect" style="display:flex; justify-content:center; margin-bottom:20px;"></div>
        <div class="card">ID: <span id="my-id">---</span></div>
        <div class="card">Hamyon: <span id="my-wallet" style="font-size:10px;">Ulanmagan</span></div>
    </div>
</div>

<div class="nav">
    <div class="nav-item" onclick="tab('p-shop', this)"><b>üõí</b>Do'kon</div>
    <div class="nav-item" onclick="loadRank(this)"><b>üèÜ</b>Reyting</div>
    <div class="nav-item active" onclick="tab('p-home', this)"><b>üè†</b>Asosiy</div>
    <div class="nav-item" onclick="tab('p-bonus', this)"><b>üéÅ</b>Bonus</div>
    <div class="nav-item" onclick="tab('p-prof', this)"><b>üë§</b>Profil</div>
</div>

<script>
// Firebase sozlash
const firebaseConfig = {
    apiKey: "AIzaSyDbttlr-oGJeDbjMbrubcuspgg9gk-7Gxs",
    authDomain: "oltin-tanga-d2c80.firebaseapp.com",
    databaseURL: "https://oltin-tanga-d2c80-default-rtdb.firebaseio.com",
    projectId: "oltin-tanga-d2c80",
    appId: "1:954210050924:web:f57b75568c66216c49c949"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();
const ton = new TONConnectUI.TonConnectUI({ manifestUrl: 'https://sizning-saytingiz.uz/tonconnect-manifest.json', buttonRootId: 'ton-connect' });

let s = { 
    id: window.Telegram?.WebApp?.initDataUnsafe?.user?.id || "dev_user", 
    name: window.Telegram?.WebApp?.initDataUnsafe?.user?.first_name || "O'yinchi",
    c: 0, d: 0, lvl: 1 
};

// Bazadan yuklash
function init() {
    db.ref('players/' + s.id).once('value').then(snap => {
        if(snap.exists()) s = snap.val();
        updateUI();
        renderShop();
    });
}

function tap(e) {
    s.c += s.lvl;
    updateUI();
    save();
    // Animatsiya effekti
    const x = e.clientX, y = e.clientY;
    const plus = document.createElement('div');
    plus.innerText = `+${s.lvl}`;
    plus.style.position = 'fixed';
    plus.style.left = x + 'px';
    plus.style.top = y + 'px';
    plus.style.color = 'var(--main)';
    plus.style.fontWeight = 'bold';
    plus.style.animation = 'floatUp 0.5s forwards';
    document.body.appendChild(plus);
    setTimeout(() => plus.remove(), 500);
}

function updateUI() {
    document.getElementById('u-bal').innerText = Math.floor(s.c).toLocaleString();
    document.getElementById('u-diam').innerText = s.d;
    document.getElementById('u-lvl').innerText = s.lvl;
    document.getElementById('u-pwr').innerText = s.lvl;
    document.getElementById('my-id').innerText = s.id;
    
    let evo = document.getElementById('evo-name');
    let coin = document.getElementById('coin-btn');
    if(s.lvl >= 20) { evo.innerText = "KOSMOS IMPERATORI"; coin.innerText = "üåå"; }
    else if(s.lvl >= 10) { evo.innerText = "MEGAPOLIS MERI"; coin.innerText = "üè¢"; }
    else { evo.innerText = "KICHIK TADBIRKOR"; coin.innerText = "üìÄ"; }
}

function renderShop() {
    const list = document.getElementById('shop-list');
    list.innerHTML = "";
    for(let i=1; i<=20; i++) {
        let price = Math.floor(1500 * Math.pow(1.6, i));
        list.innerHTML += `<div class="card">
            <div><b>Daraja ${i}</b><br><small>Tap: +${i}</small></div>
            <button class="btn-buy" onclick="buy(${i},${price})">${price.toLocaleString()} üìÄ</button>
        </div>`;
    }
}

function buy(lvl, prc) {
    if(s.c >= prc) {
        s.c -= prc; s.lvl = lvl;
        updateUI(); save();
    } else alert("Tanga yetarli emas!");
}

function tab(id, el) {
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    el.classList.add('active');
}

function loadRank(el) {
    tab('p-rank', el);
    const list = document.getElementById('rank-list');
    list.innerHTML = "Yuklanmoqda...";
    db.ref('players').orderByChild('c').limitToLast(10).once('value', snap => {
        let players = [];
        snap.forEach(c => players.push(c.val()));
        players.reverse();
        list.innerHTML = "";
        players.forEach((p, i) => {
            list.innerHTML += `<div class="rank-item">
                <span>${i+1}. ${p.name}</span>
                <b>${Math.floor(p.c).toLocaleString()}</b>
            </div>`;
        });
    });
}

function ad() {
    if(typeof show_10558007 === 'function') {
        show_10558007().then(() => { s.c += 5000; updateUI(); save(); });
    } else alert("Hozircha reklama yo'q.");
}

function daily() {
    s.c += 10000; updateUI(); save(); alert("10,000 tanga olindi!");
}

function save() { db.ref('players/' + s.id).set(s); }
ton.onStatusChange(w => { if(w) { s.wallet = w.account.address; document.getElementById('my-wallet').innerText = s.wallet.substring(0,10)+"..."; save(); }});
window.onload = init;
</script>

<style>
    @keyframes floatUp { to { transform: translateY(-50px); opacity: 0; } }
</style>
</body>
</html>

    
        
    
    
    
        
            
        
                                               
    
            
        
        
    
        
    
    
            
                
            
    
        
        
    
        
                                                       
        
                                    
        
        
    
                                        
                                                                     
        
    
                                                              
            
    
            
            
                                                      
                

