<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Tanha Empire | Influence</title>
    
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
    <script src="//libtl.com/sdk.js" data-zone="10558007" data-sdk="show_10558007"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;800&family=Outfit:wght@300;600;900&display=swap');
        
        :root { 
            --neon: #00f2ff; --gold: #fbc531; --bg: #050505; --card: #121212; 
            --danger: #ff4757; --success: #2ecc71; 
        }

        body { 
            background: var(--bg); color: #fff; font-family: 'Outfit', sans-serif; 
            margin: 0; overflow: hidden; height: 100vh; user-select: none;
        }

        /* MATRIX BACKGROUND EFFECT */
        #matrix { position: fixed; top: 0; left: 0; z-index: -1; opacity: 0.1; }

        /* HEADER */
        .header { 
            padding: 15px; display: flex; justify-content: space-between; align-items: center;
            background: rgba(0,0,0,0.85); border-bottom: 2px solid var(--neon);
        }
        .stat-box { font-family: 'JetBrains Mono'; font-weight: 800; }

        /* AVATAR SYSTEM (CSS ART) */
        .avatar-wrap { height: 35vh; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .ai-core { 
            width: 150px; height: 150px; border-radius: 30% 70% 70% 30% / 30% 30% 70% 70%;
            background: linear-gradient(45deg, var(--neon), #0057ff);
            box-shadow: 0 0 50px rgba(0, 242, 255, 0.5);
            animation: morph 6s infinite alternate ease-in-out;
            display: flex; align-items: center; justify-content: center; font-size: 50px;
        }
        @keyframes morph {
            0% { border-radius: 30% 70% 70% 30% / 30% 30% 70% 70%; }
            100% { border-radius: 50% 50% 20% 80% / 25% 80% 20% 75%; }
        }

        /* NAVIGATION */
        .nav { 
            position: fixed; bottom: 0; width: 100%; display: flex; 
            background: #000; padding: 12px 0; border-top: 1px solid #333; 
        }
        .nav-item { flex: 1; text-align: center; color: #555; font-size: 11px; cursor: pointer; transition: 0.3s; }
        .nav-item.active { color: var(--neon); text-shadow: 0 0 10px var(--neon); }
        .nav-item i { display: block; font-size: 22px; font-style: normal; margin-bottom: 3px; }

        /* CONTENT */
        .content { height: 75vh; overflow-y: auto; padding-bottom: 80px; }
        .page { display: none; padding: 20px; animation: slideUp 0.3s; }
        .active-page { display: block; }

        .card { 
            background: var(--card); border: 1px solid #222; border-radius: 15px; 
            padding: 15px; margin-bottom: 15px; position: relative; overflow: hidden;
        }
        .card::before { content: ''; position: absolute; top: 0; left: 0; width: 4px; height: 100%; background: var(--neon); }

        .btn-main { 
            background: var(--neon); color: #000; border: none; padding: 12px; 
            border-radius: 10px; font-weight: 900; width: 100%; cursor: pointer;
            font-family: 'JetBrains Mono';
        }

        /* MINI-GAME: HACKER TAP */
        #hacker-grid { 
            display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; 
            margin-top: 20px; display: none;
        }
        .node { 
            background: #111; height: 80px; border-radius: 10px; 
            display: flex; align-items: center; justify-content: center;
            font-family: 'JetBrains Mono'; color: var(--neon); border: 1px solid #333;
        }
        .active-node { background: var(--neon); color: #000; box-shadow: 0 0 20px var(--neon); }

        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<canvas id="matrix"></canvas>

<div class="header">
    <div class="stat-box" style="color:var(--neon)">$TANHA: <span id="u-bal">0</span></div>
    <div class="stat-box" style="color:var(--gold)">üíé <span id="u-diam">0</span></div>
</div>

<div class="content">
    <div id="p-home" class="page active-page">
        <div class="avatar-wrap">
            <div id="ai-core" class="ai-core" onclick="handleInfiltrate()">ü§ñ</div>
            <h2 id="ai-name" style="margin-top:20px; font-family:'JetBrains Mono';">LEVEL 1: SCRIPTER</h2>
            <div id="hacker-grid"></div>
        </div>
        <div class="card" id="status-card">
            <p style="margin:0; opacity:0.6;">NETWORK STATUS: <span style="color:var(--success)">SECURE</span></p>
            <p style="margin:5px 0 0 0; font-size:12px;">Hacking Power: +<span id="pwr">2</span> per infiltration</p>
        </div>
    </div>

    <div id="p-shop" class="page">
        <h2 style="font-family:'JetBrains Mono'; color:var(--neon);">BIO-HACKING HUB</h2>
        <div id="evo-list"></div>
    </div>

    <div id="p-risk" class="page">
        <h2 style="font-family:'JetBrains Mono'; color:var(--danger);">DARK WEB INVEST</h2>
        <div class="card">
            <h3>Binary Betting</h3>
            <p>Tikilgan pul 2 barobar bo'lishi yoki kuyishi mumkin (50/50).</p>
            <input type="number" id="bet-amt" placeholder="Summa..." style="width:100%; padding:10px; margin-bottom:10px; background:#000; border:1px solid #333; color:#fff;">
            <div style="display:flex; gap:10px;">
                <button class="btn-main" onclick="gamble('up')" style="background:var(--success)">üìà UP</button>
                <button class="btn-main" onclick="gamble('down')" style="background:var(--danger)">üìâ DOWN</button>
            </div>
        </div>
    </div>

    <div id="p-rank" class="page">
        <h2 style="font-family:'JetBrains Mono'; color:var(--gold); text-align:center;">GLOBAL HACKERS</h2>
        <div id="rank-list"></div>
    </div>

    <div id="p-prof" class="page">
        <h2 style="font-family:'JetBrains Mono';">COMMAND CENTER</h2>
        <div id="ton-connect" style="margin-bottom:20px; display:flex; justify-content:center;"></div>
        <button class="btn-main" onclick="watchAd()" style="margin-bottom:15px; background:#fff;">üì∫ DECRYPT VIDEO (+10k)</button>
        <div class="card">
            <p>ACCESS ID: <span id="p-id">0</span></p>
            <p>TON WALLET: <span id="p-wallet" style="font-size:10px; color:var(--neon)">NOT LINKED</span></p>
        </div>
    </div>
</div>

<div class="nav">
    <div class="nav-item" onclick="changeTab('p-shop', this)"><i>üß¨</i>Hub</div>
    <div class="nav-item" onclick="changeTab('p-risk', this)"><i>üè¶</i>Risk</div>
    <div class="nav-item active" onclick="changeTab('p-home', this)"><i>‚ö°</i>Hack</div>
    <div class="nav-item" onclick="loadRank(this)"><i>üèÜ</i>Rank</div>
    <div class="nav-item" onclick="changeTab('p-prof', this)"><i>üë§</i>Admin</div>
</div>

<script>
// --- CORE CONFIG ---
const firebaseConfig = {
    apiKey: "AIzaSyDbttlr-oGJeDbjMbrubcuspgg9gk-7Gxs",
    authDomain: "oltin-tanga-d2c80.firebaseapp.com",
    databaseURL: "https://oltin-tanga-d2c80-default-rtdb.firebaseio.com",
    projectId: "oltin-tanga-d2c80",
    appId: "1:954210050924:web:f57b75568c66216c49c949"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();
const ton = new TONConnectUI.TonConnectUI({ manifestUrl: 'https://sizning-saytingiz.uz/tonconnect-manifest.json', buttonRootId: 'ton-connect' });

let s = { 
    id: window.Telegram?.WebApp?.initDataUnsafe?.user?.id || "hacker_"+Math.floor(Math.random()*1000), 
    name: window.Telegram?.WebApp?.initDataUnsafe?.user?.first_name || "Unknown", 
    c: 0, d: 0, lvl: 1, last: Date.now() 
};

// --- MATRIX EFFECT ---
const canvas = document.getElementById('matrix');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth; canvas.height = window.innerHeight;
const chars = "01ABCDEFHIJKLMNOPQRSTUVWXYZ";
const drops = Array(Math.floor(canvas.width/20)).fill(1);
function drawMatrix() {
    ctx.fillStyle = "rgba(0,0,0,0.05)"; ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle = "#00f2ff"; ctx.font = "15px monospace";
    drops.forEach((y, i) => {
        const text = chars[Math.floor(Math.random()*chars.length)];
        ctx.fillText(text, i*20, y*20);
        if(y*20 > canvas.height && Math.random() > 0.975) drops[i] = 0;
        drops[i]++;
    });
}
setInterval(drawMatrix, 50);

// --- GAME LOGIC ---
function init() {
    db.ref('players/' + s.id).once('value').then(snap => {
        if(snap.exists()) s = snap.val();
        updateUI(); renderShop();
    });
}

function handleInfiltrate() {
    // Har 10 ta taptan keyin mini-hack o'yini chiqadi
    s.c += (s.lvl * 2);
    document.getElementById('ai-core').style.transform = "scale(0.8) rotate(10deg)";
    setTimeout(() => document.getElementById('ai-core').style.transform="scale(1) rotate(0deg)", 100);
    updateUI();
    if(Math.random() > 0.95) startQuickHack();
}

function startQuickHack() {
    const grid = document.getElementById('hacker-grid');
    const core = document.getElementById('ai-core');
    grid.style.display = "grid"; core.style.display = "none";
    grid.innerHTML = "";
    for(let i=0; i<9; i++) grid.innerHTML += `<div class="node" id="n-${i}" onclick="checkNode(${i})">X</div>`;
    
    let target = Math.floor(Math.random()*9);
    document.getElementById(`n-${target}`).classList.add('active-node');
    document.getElementById(`n-${target}`).innerText = "HACK";
}

function checkNode(i) {
    if(document.getElementById(`n-${i}`).classList.contains('active-node')) {
        s.c += 5000; alert("SUCCESS! +5,000 $TANHA");
    }
    document.getElementById('hacker-grid').style.display = "none";
    document.getElementById('ai-core').style.display = "flex";
}

function gamble(dir) {
    let amt = parseInt(document.getElementById('bet-amt').value);
    if(isNaN(amt) || amt > s.c || amt <= 0) return alert("Summa noto'g'ri!");
    
    let win = Math.random() > 0.5;
    if(win) { s.c += amt; alert("WIN! +"+amt); }
    else { s.c -= amt; alert("LOST! -"+amt); }
    updateUI(); save();
}

function updateUI() {
    document.getElementById('u-bal').innerText = Math.floor(s.c).toLocaleString();
    document.getElementById('u-diam').innerText = s.d;
    document.getElementById('pwr').innerText = s.lvl * 2;
    document.getElementById('p-id').innerText = s.id;
    
    const core = document.getElementById('ai-core');
    const name = document.getElementById('ai-name');
    if(s.lvl >= 20) { core.innerText = "üåå"; name.innerText = "LVL 20: DIGITAL GOD"; core.style.background = "linear-gradient(45deg, #fff, var(--gold))"; }
    else if(s.lvl >= 10) { core.innerText = "üß†"; name.innerText = "LVL 10: CYBER MIND"; core.style.background = "var(--danger)"; }
    else { core.innerText = "ü§ñ"; name.innerText = "LVL "+s.lvl+": SCRIPTER"; }
}

function renderShop() {
    const list = document.getElementById('evo-list');
    list.innerHTML = "";
    for(let i=1; i<=20; i++) {
        let cost = Math.floor(2000 * Math.pow(1.8, i));
        list.innerHTML += `<div class="card" style="display:flex; justify-content:space-between; align-items:center;">
            <span>Upgrade Link v${i}.0</span><button class="btn-main" style="width:auto; padding:5px 15px;" onclick="buy(${i},${cost})">${cost.toLocaleString()}</button>
        </div>`;
    }
}

function buy(l, c) {
    if(s.c >= c) { s.c -= c; s.lvl = l; updateUI(); save(); }
    else alert("Infiltrat yetarli emas!");
}

function loadRank(el) {
    changeTab('p-rank', el);
    const rList = document.getElementById('rank-list');
    rList.innerHTML = "SCANNING...";
    db.ref('players').orderByChild('c').limitToLast(10).once('value', snap => {
        let p = []; snap.forEach(c => p.push(c.val()));
        p.reverse(); rList.innerHTML = "";
        p.forEach((u, i) => {
            let m = (i+1)==1 ? "ü•á" : (i+1)==2 ? "ü•à" : (i+1)==3 ? "ü•â" : (i+1);
            rList.innerHTML += `<div class="card" style="display:flex; justify-content:space-between; ${i==0?'border:1px solid var(--gold)':''}">
                <span>${m} ${u.name}</span><b>${Math.floor(u.c).toLocaleString()}</b>
            </div>`;
        });
    });
}

function watchAd() {
    if(typeof show_10558007 === 'function') {
        show_10558007().then(() => { s.c += 10000; updateUI(); save(); alert("DECRYPTED! +10k"); });
    } else alert("Signal lost (Ad not ready)");
}

function changeTab(id, el) {
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active-page'));
    document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
    document.getElementById(id).classList.add('active-page'); el.classList.add('active');
}

function save() { s.last=Date.now(); db.ref('players/'+s.id).set(s); }
ton.onStatusChange(w => { if(w) { s.wallet=w.account.address; document.getElementById('p-wallet').innerText=s.wallet.substring(0,10)+"..."; save(); }});
setInterval(save, 15000);
window.onload = init;
</script>
</body>
</html>

    
        
    
    
    
        
            
        
                                               
    
            
        
        
    
        
    
    
            
                
            
    
        
        
    
        
                                                       
        
                                    
        
        
    
                                        
                                                                     
        
    
                                                              
            
    
            
            
                                                      
                

